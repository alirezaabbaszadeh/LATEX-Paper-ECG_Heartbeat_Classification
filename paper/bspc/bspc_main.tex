% BSPC submission version (Elsevier elsarticle)
\documentclass[preprint,review,3p]{elsarticle}
\usepackage{amsmath,amssymb,mathtools}
\usepackage{graphicx}
\usepackage{booktabs,multirow}
\usepackage{siunitx}
\usepackage[hidelinks]{hyperref}
\usepackage{subcaption}
\usepackage{xcolor}
\usepackage{enumitem}
\usepackage{balance}
\usepackage{lineno}
\linenumbers

\journal{Biomedical Signal Processing and Control}

% convenient macros
\newcommand{\commitsha}{384b316cf65a47b9d66035e5a868f970e89525dc}
\newcommand{\aami}{AAMI}
\newcommand{\mitbih}{MIT--BIH}

\begin{document}

%%Graphical abstract (optional but encouraged by Elsevier)
\begin{graphicalabstract}
% Provide a 531 x 1328 px (min) image when ready
% \includegraphics[width=\textwidth]{../figures/graphical_abstract_placeholder.png}
\end{graphicalabstract}

%%Research highlights (3--5 bullets, \le 85 chars each)
\begin{highlights}
\item Reproducible ECG AAMI-5 pipeline pinned to commit \commitsha
\item Morlet CWT scalograms + compact CNN+Conformer classifier
\item All tables/figures derived from repository run artifacts
\item PR/ROC, macro-F1 emphasis under class imbalance
\item Open repo; exact scripts to rebuild paper assets included
\end{highlights}

\begin{frontmatter}
\title{Reproducible ECG Heartbeat Classification under AAMI Five-Class Taxonomy using a Compact CNN+Conformer with Wavelet Scalograms}

\author[1]{Alireza Abbaszadeh\corref{cor1}}
\ead{alireza.abbaszadeh.research@gmail.com}
\author[2]{Armita Shahlaee}
\ead{Armita.shahlaee@gmail.com}
\cortext[cor1]{Corresponding author}
\address[1]{Department of Computer Engineering, Ma.C., Islamic Azad University, Mashhad, Iran}
\address[2]{Department of Biological Sciences and Technologies, Faculty of Basic Sciences, Islamic Azad University, Mashhad, Iran}

\begin{abstract}
\textbf{Background:} Automatic heartbeat classification under the \aami{} five-class taxonomy (N/S/V/F/Q) on \mitbih{} is a long-standing benchmark.\newline
\textbf{Objective:} Provide a compact, fully reproducible pipeline pinned to a public commit, with transparent evaluation derived strictly from repository artifacts.\newline
\textbf{Methods:} Beat-centered windows are converted to Morlet continuous wavelet transform (CWT) scalograms and classified by a lightweight CNN+Conformer. Training uses class-weighted cross-entropy; metrics include accuracy, macro/weighted F1, PR and ROC curves.\newline
\textbf{Results:} From the provided run reports we summarize per-class metrics, confusion matrices, ROC/PR curves, and cross-run leaderboards. Minority-class behavior is analyzed and discussed.\newline
\textbf{Conclusions:} A simple CWT+Conformer pipeline yields competitive performance with clear strengths/limitations for S and F classes; all results are reproducible from commit \commitsha{}.
\end{abstract}

\begin{keyword}
Electrocardiography (ECG) \sep Arrhythmia classification \sep AAMI taxonomy \sep Conformer \sep Wavelet scalogram \sep Inter-patient evaluation
\end{keyword}
\end{frontmatter}

\section{Introduction}
Automatic heartbeat classification under \aami{} mapping is grounded in PhysioNet and \mitbih{} \cite{Goldberger2000,Moody2001}. Early pipelines emphasized morphology and RR intervals \cite{Pan1985,deChazal2004,Llamedo2011}, while deep networks learn features directly from signals or time--frequency images \cite{Ince2009,Kiranyaz2016,Acharya2017,Oh2018,Yildirim2018,Hannun2019,Ribeiro2020,Luz2016,Zhao2020}. Our work consolidates, within a pinned snapshot, a compact CNN+Conformer approach with transparent evaluation.

\section{Related Work}
\subsection{Time--frequency front-ends}
CWT offers multiscale localization suited to ECG \cite{Addison2005,Torrence1998}; combining wavelets with CNNs is effective \cite{Gao2019CWT,Oh2018}.
\subsection{Deep learning for ECG}
Patient-specific 1D CNNs and larger end-to-end systems report strong results \cite{Kiranyaz2016,Hannun2019,Ribeiro2020}; surveys overview opportunities and challenges \cite{Luz2016,Zhao2020,Kiranyaz2021Review,Li2021TransformersECG,Faust2018}.
\subsection{Imbalance-aware metrics}
Minority classes necessitate PR curves and macro-F1 \cite{Saito2015,Fawcett2006}; we apply class-weighted losses \cite{He2009}.

\section{Materials and Methods}
\subsection{Dataset and mapping}
We adopt the \aami{} five-class taxonomy and inter-patient splits consistent with prior literature \cite{deChazal2004,Llamedo2011}.
\subsection{Preprocessing}
R-peak detection (Pan--Tompkins) \cite{Pan1985}, beat-centered windows, and Morlet-CWT scalograms \cite{Addison2005,Torrence1998} on three-beat contexts.
\subsection{Model}
A compact CNN front-end followed by Conformer blocks \cite{Gulati2020,Vaswani2017} captures both local morphology and contextual dependencies.
\subsection{Training and evaluation}
Optimization with Adam/AdamW \cite{Kingma2015,Loshchilov2019}; metrics include accuracy, macro/weighted F1, and per-class PR/ROC \cite{Saito2015,Fawcett2006}.

\section{Results}
\subsection{Overall leaderboard}
\input{../tables/leaderboard_all_runs.tex}
\subsection{Per-class metrics}
\input{../tables/main_per_class_report.tex}
\subsection{Diagnostic plots}
\begin{figure}[t]\centering
\includegraphics[width=.95\linewidth]{../figures/confusion_matrix.png}
\caption{Confusion matrix generated by repository scripts.}
\end{figure}
\begin{figure}[t]\centering
\includegraphics[width=.95\linewidth]{../figures/roc_curves.png}
\caption{One-vs-rest ROC curves.}
\end{figure}
\begin{figure}[t]\centering
\includegraphics[width=.95\linewidth]{../figures/precision_recall.png}
\caption{Precision--Recall curves per class.}
\end{figure}

\section{Discussion}
We discuss failure modes for S and F classes \cite{He2009,Saito2015}, and contrast time--frequency pipelines with direct 1D nets \cite{Kiranyaz2016,Acharya2017}. Conformer layers may improve context modeling over pure CNNs \cite{Gulati2020}.

\section{Reproducibility and Availability}
All tables/figures are generated or copied from repository artifacts pinned to commit \commitsha{}. Data access follows PhysioNet guidance \cite{Goldberger2000}.

\section*{CRediT authorship contribution statement}
\textbf{Alireza Abbaszadeh}: Conceptualization, Methodology, Software, Validation, Investigation, Writing--original draft, Visualization.\newline
\textbf{Armita Shahlaee}: Validation, Investigation, Writing--review \& editing.

\section*{Declaration of competing interest}
The authors declare no competing interests.

\section*{Data availability}
All data used are from publicly available PhysioNet databases; scripts and artifacts to reproduce results are included in the linked repository at commit \commitsha{}.

\section*{Acknowledgments}
We thank the PhysioNet community and prior authors for open datasets and tooling.

\bibliographystyle{elsarticle-num}
\bibliography{../references}

\end{document}
